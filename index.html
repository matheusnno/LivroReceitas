<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Minhas Receitas</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>Minhas Receitas</h1>
    <a class="btn" href="nova.html">Nova Receita</a>
  </header>

  <main>
    <div id="listaReceitas" class="grid"></div>
  </main>

  <script src="js/app.js"></script>
  <script>
    async function carregarReceitas() {
      try {
        const receitas = await api.listarReceitas();
        const container = document.getElementById('listaReceitas');
        container.innerHTML = '';

        if (!receitas.length) {
          container.innerHTML = '<p>Nenhuma receita cadastrada.</p>';
          return;
        }

        receitas.forEach(r => {
          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <h2>${r.nome}</h2>
            <p><strong>Categoria:</strong> ${r.categoria || '-'}</p>
            <p><strong>Tempo de Preparo:</strong> ${r.tempo_preparo || '-'} min</p>
            <div class="actions">
              <a class="btn" href="receita.html?id=${r.id}">Abrir</a>
              <a class="btn" href="nova.html?id=${r.id}">Editar</a>
              <button class="btn btn-danger" onclick="deletarReceita(${r.id})">Excluir</button>
            </div>
          `;
          container.appendChild(card);
        });
      } catch (err) {
        console.error("Erro ao carregar receitas:", err);
        alert("Erro ao carregar receitas.");
      }
    }

    async function deletarReceita(id) {
      if (!confirm("Tem certeza que deseja excluir esta receita?")) return;
      try {
        await api.deletarReceita(id);
        carregarReceitas();
      } catch (err) {
        console.error("Erro ao deletar receita:", err);
        alert("Erro ao deletar receita.");
      }
    }

    carregarReceitas();
  </script>
</body>
</html>
